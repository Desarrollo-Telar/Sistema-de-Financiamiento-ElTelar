{% load static %}


<div class="row" style="margin-top: 1rem;">
    <div class="col-12 ">
        <div class="table-responsive">
            <table class="table table-hover">
                <thead>
                    <tr>

                        <th scope="col">Fecha de Emision</th>
                        <th scope="col">No. Referencia</th>
                        <th scope="col">Descripcion</th>
                        <th scope="col">Monto Pagado</th>
                        <th scope="col">Desembolso</th>
                        <th scope="col">Mora Pagado</th>
                        <th scope="col">Interes Pagado</th>
                        <th scope="col">Aporte a Capital</th>
                        <th scope="col">Saldo Capital Pendiente</th>
                        <th scope="col"></th>
                        <th scope="col"></th>


                    </tr>
                </thead>
                <tbody>
                    {% for cuenta_estado in estado_cuenta %}

                    <tr>

                        <td scope="row">

                            {{cuenta_estado.fecha_emision}}

                        </td>
                        <td scope="row">


                            {{cuenta_estado.numero_referencia}}

                        </td>
                        <td scope="row">
                            <p>{{cuenta_estado.description}}</p>

                        </td>
                        <td scope="row">
                            Q {{cuenta_estado.abono}}
                        </td>
                        <td scope="row">
                            Q {{cuenta_estado.disbursement_paid}}
                        </td>
                        <td scope="row">
                            Q {{cuenta_estado.late_fee_paid}}
                        </td>
                        <td scope="row">
                            Q {{cuenta_estado.interest_paid}}
                        </td>
                        <td scope="row">
                            Q {{cuenta_estado.capital_paid}}
                        </td>
                        <td scope="row">
                            Q {{cuenta_estado.saldo_pendiente}}
                        </td>
                        <td>
                            {% if cuenta_estado.payment %}
                            <a href="{% url 'financings:recibo' cuenta_estado.payment.id %}">RECIBO</a>
                            {% endif %}

                            {% if cuenta_estado.disbursement %}
                            <a
                                href="{% url 'financings:detail_disbursement' cuenta_estado.disbursement.id %}">DESEMBOLSO</a>

                            {% endif %}

                        </td>
                        <td>
                            {% if cuenta_estado.payment %}
                            {% if cuenta_estado.payment.factura %}
                            <a href="{% url 'financings:factura' cuenta_estado.payment.id %}">Ver factura</a>
                            {% else %}
                            <a href="{% url 'financings:generar_factura' cuenta_estado.payment.id %}">Generar
                                Factura</a>
                            {% endif %}

                            {% endif%}
                        </td>
                    </tr>

                    {% endfor %}
                    <tr>
                        <th scope="row" colspan="4" class="text-center">TOTALES</th>
                        <td>Q {{total_desembolsos}}</td>
                        <td>Q {{total_moras}}</td>
                        <td>Q {{total_intereses}}</td>
                        <td>Q {{total_capital}}</td>
                        <td></td>
                        <td></td>

                    </tr>
                    <tr style="margin-top: 1rem; text-align: center;">
                        <td colspan="11">SIGUIENTE CUOTA</td>
                    </tr>
                    <tr>
                        <th scope="col">Fecha de Inicio</th>
                        <th scope="col">Fecha de Vencimiento</th>
                        <th scope="col">Fecha Limite de Pago</th>
                        <th scope="col">Mora Acumulado</th>
                        <th scope="col">Interes Acumulado</th>
                        <th scope="col">Capital</th>
                        <th scope="col">Cuota A Cancelar</th>
                        <th scope="col" colspan="2">Saldo A Capital Pendiente</th>
                        <th colspan="2"></th>

                    </tr>
                    <tr>
                        <td scope="row">{{siguiente_pago.start_date}}</td>
                        <td scope="row">{{siguiente_pago.due_date}}</td>
                        <td scope="row">{{siguiente_pago.mostrar_fecha_limite}}</td>
                        <td scope="row">Q {{siguiente_pago.mora}}</td>
                        <td scope="row">Q {{siguiente_pago.interest}}</td>
                        <td scope="row">Q {{siguiente_pago.calculo_capital}}</td>
                        <td scope="row">Q {{siguiente_pago.total}}</td>
                        <td scope="row" colspan="2">Q {{siguiente_pago.saldo_pendiente}}</td>


                        <td scope="row" colspan="2" style="text-align: center;">
                            <a href="{% url 'financings:paymente_update_cuota' siguiente_pago.id %}">Modificar</a>

                        </td>
                    </tr>
                    <tr style="margin-top: 1rem; text-align: center;">
                        <td colspan="11">
                            <a href="{% url 'financings:estado_cuenta' credit_list.id %}">ESTADO DE CUENTA</a>
                        </td>



                    </tr>
                </tbody>
            </table>
        </div>
    </div>
    <hr>



</div>
<!-- CONENCTORES -->