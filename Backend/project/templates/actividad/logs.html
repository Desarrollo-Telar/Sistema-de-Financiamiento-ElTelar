{% extends 'base.html'%}
{% load static %}
{% block css %}
<link rel="stylesheet" href="{% static 'css/actividad/logs.css'%}">
{% endblock %}
{% block content %}
<div class="container box">
    <!-- Header -->
    <div class="welcome-section animate-fade-in">
        <h4>
            <span>üîç</span> Sistema de Logs Unificado
        </h4>
        <p class="fs-6">Monitoreo en tiempo real de actividades de usuarios y eventos del sistema</p>
    </div>

    <!-- Stats -->
    <div class="stats-grid animate-slide-up">
        <div class="stat-card user">
            <div class="stat-value">1,243</div>
            <div class="stat-label">User Logs</div>
        </div>
        <div class="stat-card system">
            <div class="stat-value">856</div>
            <div class="stat-label">System Logs</div>
        </div>
        <div class="stat-card error">
            <div class="stat-value">23</div>
            <div class="stat-label">Errores</div>
        </div>
        <div class="stat-card warning">
            <div class="stat-value">67</div>
            <div class="stat-label">Advertencias</div>
        </div>
    </div>

    <!-- Controls -->
    <div class="controls">
        <div class="controls-row">
            <input type="text" class="search-box" placeholder="üîç Buscar en logs (usuario, acci√≥n, mensaje, IP...)">

            <div class="filter-group">
                <label>Tipo:</label>
                <select>
                    <option value="">Todos</option>
                    <option value="user">User Logs</option>
                    <option value="system">System Logs</option>
                </select>
            </div>

            <div class="filter-group">
                <label>Nivel:</label>
                <select>
                    <option value="">Todos</option>
                    <option value="debug">Debug</option>
                    <option value="info">Info</option>
                    <option value="warning">Warning</option>
                    <option value="error">Error</option>
                    <option value="critical">Critical</option>
                </select>
            </div>

            <div class="filter-group">
                <label>Categor√≠a:</label>
                <select>
                    <option value="">Todas</option>
                    <option value="auth">Autenticaci√≥n</option>
                    <option value="database">Base de Datos</option>
                    <option value="api">API</option>
                    <option value="security">Seguridad</option>
                </select>
            </div>

            <div class="filter-group">
                <label>Desde:</label>
                <input type="datetime-local" value="2025-10-20T00:00">
            </div>

            <button class="btn btn-primary">Filtrar</button>
            <button class="btn btn-secondary">Limpiar</button>
        </div>
    </div>

    <!-- Logs Container -->
    <div class="logs-container">
        <!-- User Log Entry -->
        {% for user_log, system_log in page_obj %}
        {% if user_log %}
        <div class="log-entry" onclick="this.querySelector('.expandable-content').classList.toggle('active')">
            <div class="log-header">
                <div class="log-main">
                    <div class="log-icon user-log">üë§</div>
                    <div class="log-content">
                        <div class="log-title"> {{user_log.action}}</div>
                        <div class="log-details">{{user_log.details}}</div>
                        <div class="log-meta">
                            <div class="meta-item">
                                <strong>Usuario:</strong> {{user_log.user}}
                            </div>
                            <div class="meta-item">
                                <strong>IP:</strong> {{user_log.ip_address}}
                            </div>
                            <div class="meta-item">
                                <strong>Navegador:</strong> {{user_log.user_agent}}
                            </div>
                            <div class="meta-item">
                                <strong>Categor√≠a:</strong> {{user_log.category}}
                            </div>
                        </div>
                    </div>
                </div>
                <div class="log-badges">
                    <span class="badge badge-user">User Log</span>
                    <span class="badge badge-info">Info</span>
                    <div class="timestamp">{{user_log.timestamp}}</div>
                </div>
            </div>
            
        </div>
        {% endif%}
        {% if system_log %}
        <div class="log-entry" onclick="this.querySelector('.expandable-content').classList.toggle('active')">
            <div class="log-header">
                <div class="log-main">
                    <div class="log-icon system-log">‚öôÔ∏è</div>
                    <div class="log-content">
                        <div class="log-title">{{system_log.source}}</div>
                        <div class="log-details">
                            {{system_log.message}}
                        </div>
                        <div class="log-meta">
                            <div class="meta-item">
                                <strong>Fuente:</strong> {{system_log.traceback}}
                            </div>
                            <div class="meta-item">
                                <strong>Categor√≠a:</strong> {{system_log.category}}
                            </div>
                        </div>
                    </div>
                </div>
                <div class="log-badges">
                    <span class="badge badge-system">System Log</span>
                    <span class="badge {%if system_log.level.name == 'INFO' %} badge-info {% elif system_log.level.name == 'DEBUG' %} badge-info {% elif system_log.level.name == 'WARNING' %}  badge-warning {% else %} badge-error {% endif%}">
                        {%if system_log.level.name == 'INFO' %} 
                        INFO 
                        {% elif system_log.level.name == 'DEBUG' %} 
                        DEBUG 
                        {% elif system_log.level.name == 'WARNING' %} 
                        WARNING 
                        {% elif system_log.level.name == 'ERROR' %} 
                        ERROR 
                        {% elif system_log.level.name == 'CRITICAL' %} 
                        CRITICAL
                        {% endif%}
                    </span>
                    <div class="timestamp">{{ system_log.timestamp}}</div>
                </div>
            </div>
            {% if system_log.traceback %}
            <div class="expandable-content">
                <strong style="color: #9ca3af; font-size: 12px;">TRACEBACK:</strong>
                <div class="code-block">{{system_log.traceback}}</div>
                
            </div>
            {% endif %}
        </div>

        {% endif %}

        {% endfor %}

        

      

        
    </div>

    <!-- Pagination -->
    {% if page_obj %}
    <div class="row" style="margin-top: 5rem; ">
        {% include 'snippets/pages.html' %}
    </div>
    {% endif %}
</div>
{% endblock %}